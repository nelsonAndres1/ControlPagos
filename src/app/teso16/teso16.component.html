<h2>Estado del Pago</h2>
<br />
<br />

<form>
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Tipo de Pago</th>
        <th scope="col">Estado</th>
        <th scope="col">Usuario</th>
        <th scope="col">Valor</th>
        <th scope="col">Fecha</th>
        <th scope="col">Hora</th>
        <th scope="col">Soportes</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let r of item1">
        <td>{{ item2.detclas }}</td>
        <td>{{ obtenerNombreEstado(r.estado) }}</td>
        <td>
          <a (click)="nombreUsuario(r.usuario)" style="cursor: pointer;">{{ r.usuario }}</a>
        </td>
        <td>${{ data?.valor }}</td>
        <td>{{ r.fecha }}</td>
        <td>{{ r.hora }}</td>
        <td>
          <button type="button" class="btn btn-sm btn-link" (click)="toggleVisor()">
            {{ visorAbierto ? 'Ocultar' : 'Ver' }}
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Soportes del pago (mismos métodos que usas en Teso117) -->
  <h3 class="mt-3">Soportes del Pago</h3>

  <div *ngIf="cargandoSoportes" class="mb-2">
    Cargando soportes...
  </div>

  <div *ngIf="!cargandoSoportes && soportes?.length; else noSoportes">
    <div *ngFor="let so of soportes" class="mb-3">
      <div class="d-flex align-items-center gap-2">
        <strong class="flex-1">
          {{ so.detsop || so.descripcion || so.archivo }}
        </strong>

        <button type="button" class="btn btn-sm btn-outline-secondary" (click)="verPDF(so)">
          Ver
        </button>

<!--         <button type="button" class="btn btn-sm btn-outline-primary" (click)="downloadPDF(so)">
          Descargar
        </button> -->
      </div>

      <!-- Visor embebido (misma librería y enfoque) -->
      <div *ngIf="visorAbierto && so === soporteSeleccionado" class="mt-2">
        <pdf-viewer [src]="global_url + 'teso12/getDocumento/' + so.archivo" [rotation]="0" [original-size]="false"
          [show-all]="true" [fit-to-page]="false" [zoom]="1" [zoom-scale]="'page-width'" [stick-to-page]="false"
          [render-text]="true" [external-link-target]="'blank'" [autoresize]="true" [show-borders]="false"
          style="width: 100%; height: 400px;"></pdf-viewer>
      </div>
    </div>
  </div>

  <ng-template #noSoportes>
    <em>Sin soportes para este pago.</em>
  </ng-template>
</form>